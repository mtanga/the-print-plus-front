<div class="bg-light" style="margin-top:15px;margin-bottom: -50px;padding-bottom: 50px;">
  <div class="container">
    <div class="py-5 text-left">
      <h2>Paiement</h2>
    </div>

    <div class="row re-mobile">

            
      <div class="col-md-4 order-md-2 mb-4">
        <h4 class="d-flex justify-content-between align-items-center mb-3">
          <span class="text-muted">Votre panier</span>
          <span style="color: #01b0ef!important;" class="badge badge-secondary badge-pill">{{product?.length}} produit(s)</span>
        </h4>
        <ul class="list-group mb-3">
          <li *ngFor="let item of product;" class="list-group-item d-flex justify-content-between lh-condensed">
            <div>
              <h6 class="my-0">{{item.products.product.name}}</h6>
              <small class="text-muted">Quantié : {{item.products.qte}} </small>
            </div>
            <span class="text-muted">{{total(item.products.price, item.products.qte)}} F CFA</span>
          </li>
          <li  class="list-group-item d-flex justify-content-between lh-condensed">
            <div >
              <h6 class="my-0">Livraison : {{itemDel.name}}</h6>
              <span class="text-muted">{{itemDel.price || 0}} F CFA</span>
              <p class="list-group mb-3"><small class="text-muted">{{itemDel.description}}</small></p>
            </div>
           
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>Total à payer</span>
            <strong>{{totalAmount() + (int(itemDel.price) || 0) }} F CFA</strong>
          </li>
        </ul>

        <div class="row">
          <div class="col-md-6 mb-3">
            <input type="text" [(ngModel)]="code_promo" class="form-control"  name="fisrt_name" placeholder="code promo" required>
            <div class="invalid-feedback">
              Valid first name is required.
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <button [disabled]="code_promo==undefined || code_promo=='' || select_box==undefined"  (click)="apply()" style="width: 100%;" class="btn btn-primary btn-lg btn-block" type="btn">Appliquer</button> 
          </div>
        </div>

        <ul class="list-group mb-3" *ngIf="promoPrice>0">
          <li class="list-group-item d-flex justify-content-between">
            <span>Réduction</span>
            <strong>- {{promoPrice}} F CFA</strong>
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>Net à payer</span>
            <strong>{{realPrice}} F CFA</strong>
          </li>
        </ul>


        <h4 style="padding-top:20px;" class="mb-3">Information de paiement</h4>
        <div class="mobile-pay">
          <div class="row">
            <div class="col-md-5 mb-3">
              <label>Type de portefeuille mobile</label>
              <select  [(ngModel)]="paymement_type" name="paymement_type" class="form-select" id="paymement_type" (change)="onPay($event)">
                <option class="dropdown-item" disabled selected value="undefined">Selectionnez une méthode de livraison</option>
                <option *ngFor="let item of services;" value="{{item.id}}">{{item.name}}</option>
              </select>
            </div>
            <div class="col-md-7 mb-3">
              <div class="form-group mb-1">
                <label for="exampleInputPassword1">Numéro de téléphone de votre portefeuille</label><br>
                <input type="text"
                [value]=""
                name = "phone"
                class="form-control phone"
                ng2TelInput
                [ng2TelInputOptions]="{initialCountry: 'cm'}"
                (hasError)="hasErrors($event)"
                (ng2TelOutput)="getNumbers($event)"
                (intlTelInputObject)="telInputObjects($event)"
                (countryChange)="onCountryChanges($event)" />
              </div>
            </div>
          </div>

          <div >
            <button [disabled]="select_box==undefined || hitCodeDiv"  (click)="payByMobileMoney()" style="width: 100%;" class="btn btn-primary btn-lg btn-block" type="btn">Valider et payer maintenant </button> 
          </div>

          <div *ngIf="hitCodeDiv">
            <h4 style="padding-top:20px;" class="mb-3">Validation du paiement</h4>
            <p style="color:green;">Veuillez valider la transaction sur votre téléphone pour continuer</p>
            <p style="color:blue;">Si vous venez de valider la transaction sur vore téléphone veuilez cliquez sur le bouton ci- dessous pour poursuire.</p>

            <p style="color:red;">Ne fermez pas cette. Ne raffraichissez pas la page.</p>
            <button [disabled]="timeLeft>0"  (click)="continue()" style="width: 100%;" class="btn btn-success btn-lg btn-block" type="btn">Confirmer le paiement  <br/><small class="petit">{{this.sec}}</small></button> 
          </div> 
         

         
        </div>
        
       <!--  <button  (click)="buyNow()" style="width: 100%;" class="btn btn-primary btn-lg btn-block" type="btn">Valider et payer maintenant</button> -->
      </div>


      <div class="col-md-8 order-md-1">
        <h4 class="mb-3">Information de facturation</h4>
          <form class="needs-validation" #f="ngForm" (ngSubmit)="profile()" name="Form" novalidate>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="firstName">Prénom</label>
                    <input   (change)="check_profile_completed_update()" type="text" class="form-control"  name="fisrt_name" [value]="user.fisrt_name" required>
                    <div class="invalid-feedback">
                      Valid first name is required.
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="lastName">Nom</label>
                    <input  (change)="!edit" type="text" class="form-control"  name="last_name" [value]="user.last_name" required>
                    <div class="invalid-feedback">
                      Valid last name is required.
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="form-group mb-1">
                        <label for="exampleInputPassword1">Téléphone</label><br>
                        <input type="text"
                        [value]="infos?.phone"
                        name = "phone"
                        class="form-control phone"
                        ng2TelInput
                        [ng2TelInputOptions]="{initialCountry: 'cm'}"
                        (hasError)="hasError($event)"
                        (ng2TelOutput)="getNumber($event)"
                        (intlTelInputObject)="telInputObject($event)"
                        (countryChange)="onCountryChange($event)" />

                    </div>
                </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                      <label for="lastName">Région</label>
                      <input  (change)="check_profile_completed_update()" type="text" class="form-control"  name="region" [value]="infos?.region || ''" required>
                      <div class="invalid-feedback">
                        Valid last name is required.
                      </div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <label for="firstName">Ville</label>
                      <input   (change)="check_profile_completed_update()" type="text" class="form-control"  name="ville" [value]="infos?.ville" required>
                      <div class="invalid-feedback">
                        Valid first name is required.
                      </div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <label for="address">Quartier</label>
                      <input   (change)="check_profile_completed_update()" type="text" class="form-control"  name="rue" [value]="infos?.rue" required>
                      <div class="invalid-feedback">
                        Please enter your shipping address.
                      </div>
                    </div>
                </div>

            <!--   <span *ngIf="!check_profile_completed_update()" ><a [routerLink]="['/mon-compte']" style="color:green;">Enregistrer maintenant vos modifications avant de poursuivre</a>.</span>  -->
                <button *ngIf="!check_profile_completed_update()" (click)="profile()" type="btn" class="btn btn-info">Modifier votre profil</button>

          <hr class="mb-4">
          <h4 class="mb-3">Information de livraison</h4>
          <div class="my-3">
              <div class="form-check">
                <input (change)="handleChanged($event)" id="liv" name="liv" type="radio" class="form-check-input" value="domicile" checked required>
                <label class="form-check-label" for="credit">Livraison à domicile</label>
              </div>
              <div class="form-check">
                <input (change)="handleChanged($event)" id="liv" name="liv" type="radio" class="form-check-input" value="partenaire" checked required>
                <label class="form-check-label" for="credit">Retrait chez le partenaire</label>
              </div>
              <div class="form-check">
                <input (change)="handleChanged($event)" id="liv" name="liv" type="radio" value="agence" class="form-check-input" required>
                <label class="form-check-label" for="debit">Retrait à l'agence</label>
              </div>
            </div> 
            <div class="my-3">
              <div class="">
                <select *ngIf="delivery_type=='domicile'" [(ngModel)]="select_box" name="select_box" class="form-select" id="select_box" (change)="onChange($event)">
                  <option class="dropdown-item" disabled selected value="undefined">Selectionnez une méthode de livraison</option>
                  <option *ngFor="let point of pointsD;" value="{{point.id}}">{{point.name}}</option>
                 
                </select>
                <select *ngIf="delivery_type=='partenaire'" [(ngModel)]="select_box" name="select_box" class="form-select" id="select_box" (change)="onChange($event)">
                  <option class="dropdown-item" disabled selected value="undefined">Selectionnez une méthode de livraison</option>
                  <option *ngFor="let point of pointsP;" value="{{point.id}}">{{point.name}}</option>
                </select>

                <select *ngIf="delivery_type=='agence'" [(ngModel)]="select_box" name="select_box" class="form-select" id="select_box" (change)="onChange($event)">
                  <option class="dropdown-item" disabled selected value="undefined">Selectionnez une méthode de livraison</option>
                  <option *ngFor="let point of pointsA;" value="{{point.id}}">{{point.name}}</option>
                </select>
              </div>


            </div> 

        </form>
      </div>
    </div>
    <ng-template #customLoadingTemplate>
      <div class="custom-class">
       
      </div>
    </ng-template>
    <ngx-loading
    [show]="loading"
    [config]="{ backdropBorderRadius: '3px' }"
    [template]="customLoadingTemplate"
  ></ngx-loading>



  </div>
</div>





